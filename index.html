<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ø­Ø§ÙØ¸Ø© Ø§Ù„Ø¥Ø³ÙƒÙ†Ø¯Ø±ÙŠØ© - Ø§Ù„Ø§Ø³ØªØ¹Ù„Ø§Ù… Ø§Ù„Ù…ÙƒØ§Ù†ÙŠ</title>
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap" rel="stylesheet">

    <style>
        /* Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù‡ÙˆÙŠØ© Ø§Ù„Ø¨ØµØ±ÙŠØ© */
        :root {
            --primary-color: #1A3C6B; /* Ø£Ø²Ø±Ù‚ Ø¯Ø§ÙƒÙ† Ø±Ø³Ù…ÙŠ */
            --accent-color: #2ECC71;  /* Ø£Ø®Ø¶Ø± Ù„Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª */
            --bg-color: #F8F9FA;
            --text-dark: #2c3e50;
        }

        body {
            margin: 0;
            padding: 0;
            font-family: 'Tajawal', sans-serif;
            background-color: var(--bg-color);
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¹Ù„ÙˆÙŠ */
        .header {
            background-color: var(--primary-color);
            color: white;
            padding: 15px 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .header img { height: 40px; } /* Ù…ÙƒØ§Ù† Ø§Ù„Ø´Ø¹Ø§Ø± */
        .header h1 { margin: 0; font-size: 1.2rem; font-weight: 700; }

        /* Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ø®Ø±ÙŠØ·Ø© */
        #map {
            flex-grow: 1;
            width: 100%;
            z-index: 1;
        }

        /* Ù…Ø¤Ø´Ø± Ø§Ù„Ù…Ù†ØªØµÙ Ø§Ù„Ø«Ø§Ø¨Øª */
        .center-marker {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 999;
            pointer-events: none; /* ÙŠØ³Ù…Ø­ Ø¨Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø±ÙŠØ·Ø© ØªØ­ØªÙ‡ */
        }
        
        .pin-bounce {
            animation: bounce 1s infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translate(-50%, -50%) translateY(0); }
            50% { transform: translate(-50%, -50%) translateY(-10px); }
        }

        /* Ø²Ø± Ø§Ù„Ø§Ø³ØªØ¹Ù„Ø§Ù… Ø§Ù„Ø¹Ø§Ø¦Ù… */
        .action-container {
            position: absolute;
            bottom: 30px;
            left: 0;
            right: 0;
            padding: 0 20px;
            z-index: 1000;
            display: flex;
            justify-content: center;
        }

        .btn-check {
            background-color: var(--accent-color);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: bold;
            font-family: 'Tajawal', sans-serif;
            box-shadow: 0 4px 15px rgba(46, 204, 113, 0.4);
            cursor: pointer;
            transition: transform 0.2s;
            width: 100%;
            max-width: 400px;
        }

        .btn-check:active { transform: scale(0.98); }

        /* Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ù†ØªÙŠØ¬Ø© (Modal) */
        .result-modal {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: white;
            padding: 25px;
            border-radius: 20px 20px 0 0;
            box-shadow: 0 -5px 20px rgba(0,0,0,0.15);
            z-index: 2000;
            transform: translateY(110%);
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .result-modal.show { transform: translateY(0); }

        .result-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
        }

        .result-title { font-size: 1.1rem; color: var(--primary-color); font-weight: bold; }
        .close-btn { background: none; border: none; font-size: 1.5rem; cursor: pointer; color: #999; }

        .info-row {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
        }

        .info-icon { font-size: 1.5rem; margin-left: 15px; }
        .info-label { font-size: 0.9rem; color: #7f8c8d; display: block; margin-bottom: 3px;}
        .info-value { font-size: 1.1rem; color: var(--text-dark); font-weight: bold; }

        .status-badge {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 0.8rem;
            margin-top: 5px;
        }
        .status-commercial { background-color: #e3f2fd; color: #1976d2; }
        .status-residential { background-color: #e8f5e9; color: #2e7d32; }
        .status-unknown { background-color: #f3e5f5; color: #7b1fa2; }

    </style>
</head>
<body>

    <div class="header">
        <div style="width: 40px; height: 40px; background: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; color: var(--primary-color);">Ù…</div>
        <div>
            <h1>Ù…Ø­Ø§ÙØ¸Ø© Ø§Ù„Ø¥Ø³ÙƒÙ†Ø¯Ø±ÙŠØ©</h1>
            <span style="font-size: 0.8rem; opacity: 0.9;">Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ø§Ø³ØªØ¹Ù„Ø§Ù… Ø§Ù„Ù…ÙƒØ§Ù†ÙŠ</span>
        </div>
    </div>

    <div id="map"></div>

    <div class="center-marker">
        <svg width="40" height="40" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M12 0C7.58 0 4 3.58 4 8C4 14.42 12 24 12 24C12 24 20 14.42 20 8C20 3.58 16.42 0 12 0ZM12 11C10.34 11 9 9.66 9 8C9 6.34 10.34 5 12 5C13.66 5 15 6.34 15 8C15 9.66 13.66 11 12 11Z" fill="#E74C3C"/>
        </svg>
    </div>

    <div class="action-container">
        <button class="btn-check" onclick="checkLocation()">ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…Ù†Ø·Ù‚Ø©</button>
    </div>

    <div id="resultModal" class="result-modal">
        <div class="result-header">
            <span class="result-title">Ù†ØªÙŠØ¬Ø© Ø§Ù„Ø§Ø³ØªØ¹Ù„Ø§Ù…</span>
            <button class="close-btn" onclick="closeModal()">&times;</button>
        </div>
        
        <div class="info-row">
            <div class="info-icon">ğŸ“</div>
            <div>
                <span class="info-label">Ø§Ù„Ø­ÙŠ Ø§Ù„ØªØ§Ø¨Ø¹</span>
                <span class="info-value" id="districtName">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</span>
            </div>
        </div>

        <div class="info-row">
            <div class="info-icon">ğŸ˜ï¸</div>
            <div>
                <span class="info-label">Ù†ÙˆØ¹ Ø§Ù„Ù…Ù†Ø·Ù‚Ø©</span>
                <span class="info-value" id="districtType">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</span>
                <div id="typeBadge"></div>
            </div>
        </div>
        
        <div style="text-align: center; font-size: 0.8rem; color: #999; margin-top: 10px;">
            Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø³ØªØ®Ø±Ø¬Ø© Ù…Ù† Ø§Ù„Ù…Ø®Ø·Ø· Ø§Ù„Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠ Ø§Ù„Ù…Ø¹ØªÙ…Ø¯ Ù„Ø­ÙŠ Ø´Ø±Ù‚
        </div>
    </div>

    <script>
        // 1. ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (ØªÙ… Ø¯Ù…Ø¬ Ù…Ø­ØªÙˆÙ‰ Ù…Ù„Ù sharq.json Ù‡Ù†Ø§ Ù„Ù„Ù…Ø­Ø§ÙƒØ§Ø©)
        // ÙÙŠ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØŒ ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„ Ù‡Ø°Ø§ Ø§Ù„Ù…Ù„Ù Ù…Ù† Ø§Ù„Ø³ÙŠØ±ÙØ±
        const geoData = {
            "features": [
                // Ù…Ù‚ØªØ·Ù Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª - Ø³ÙŠØªÙ… Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙƒØ§Ù…Ù„Ø© ÙÙŠ Ø§Ù„ØªÙ†ÙÙŠØ° Ø§Ù„ÙØ¹Ù„ÙŠ
                // Ù„Ù‚Ø¯ Ù‚Ù…Øª Ø¨Ø¥Ø¯Ø±Ø§Ø¬ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ© Ù…Ù† Ù…Ù„ÙÙƒ Ù„ÙŠØ¹Ù…Ù„ Ø§Ù„ÙƒÙˆØ¯ Ø¨Ø¯Ù‚Ø©
                 {"attributes":{"FID":0,"Ø§Ù„Ø­ÙŠ":"Ø´Ø±Ù‚","type":"Ø§Ù‚ØªØµØ§Ø¯ÙŠØ©"},"geometry":{"rings":[[[30.052622,31.184940],[30.052972,31.184622],[30.050795,31.182809],[30.048439,31.180760],[30.029899,31.173005],[29.995518,31.162961],[29.995039,31.180458],[29.996257,31.184936],[30.052622,31.184940]]]}},
                 {"attributes":{"FID":1,"Ø§Ù„Ø­ÙŠ":"Ø´Ø±Ù‚","type":"Ø³ÙƒÙ†ÙŠØ©"},"geometry":{"rings":[[[29.994560,31.205895],[29.994336,31.209127],[30.007596,31.211721],[30.015793,31.206988],[30.035072,31.198364],[30.021116,31.201194],[29.994560,31.205895]]]}},
                 // ... (ØªÙ… Ø§Ø®ØªØµØ§Ø± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù†ØµÙŠ Ù„Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø³Ø§Ø­Ø©ØŒ 
                 // Ù„ÙƒÙ† Ø§Ù„ÙƒÙˆØ¯ Ø³ÙŠØ¹Ù…Ù„ Ø¨Ù…Ù†Ø·Ù‚ Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙƒØ§Ù…Ù„Ø© Ø¥Ø°Ø§ Ø£Ø¶ÙØª Ø¨Ø§Ù‚ÙŠ Ø§Ù„ features Ù‡Ù†Ø§)
                 // Ù…Ù„Ø§Ø­Ø¸Ø©: Ù„ÙƒÙŠ ÙŠØ¹Ù…Ù„ Ø§Ù„ÙƒÙˆØ¯ Ø¨Ø¯Ù‚Ø© 100% Ù…Ø¹ Ù…Ù„ÙÙƒØŒ Ø³Ø£Ù‚ÙˆÙ… Ø¨ÙˆØ¶Ø¹ Ø§Ù„Ù…Ù†Ø·Ù‚ Ø§Ù„Ø°ÙŠ ÙŠØ¹Ø§Ù„Ø¬ Ø§Ù„Ù…Ù„Ù Ø§Ù„ÙƒØ§Ù…Ù„
            ]
        };
        
        // **Ù‡Ø§Ù…:** Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¯Ù‚Ø© ÙƒØ§Ù…Ù„Ø©ØŒ ÙŠØ¬Ø¨ Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ù…ØµÙÙˆÙØ© features Ø£Ø¹Ù„Ø§Ù‡
        // Ø¨Ù…Ø­ØªÙˆÙ‰ Ù…ØµÙÙˆÙØ© "features" Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø© ÙÙŠ Ù…Ù„Ù sharq.json Ø¨Ø§Ù„ÙƒØ§Ù…Ù„.
        // Ù‚Ù…Øª Ø¨ÙˆØ¶Ø¹ Ù…Ø¶Ù„Ø¹ÙŠÙ† ÙÙ‚Ø· ÙƒÙ…Ø«Ø§Ù„ (Ø³Ù…ÙˆØ­Ø© / Ø§Ù„Ø´Ø±Ù‚) Ù„Ù„ØªØ¬Ø±Ø¨Ø©.

        // 2. Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø®Ø±ÙŠØ·Ø©
        // Ø§Ù„ØªØ±ÙƒÙŠØ² Ø§Ù„Ù…Ø¨Ø¯Ø¦ÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ø¥Ø³ÙƒÙ†Ø¯Ø±ÙŠØ© (Ø­ÙŠ Ø´Ø±Ù‚)
        const map = L.map('map', { zoomControl: false }).setView([31.2001, 29.9600], 13);
        
        // Ø¥Ø¶Ø§ÙØ© Ø·Ø¨Ù‚Ø© Ø®Ø±ÙŠØ·Ø© Ø§Ù„Ø´ÙˆØ§Ø±Ø¹ (OpenStreetMap) Ø¨ØªØµÙ…ÙŠÙ… ÙØ§ØªØ­ ÙˆÙ†Ø¸ÙŠÙ
        L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
            attribution: 'Â© OpenStreetMap contributors'
        }).addTo(map);

        // 3. Ø®ÙˆØ§Ø±Ø²Ù…ÙŠØ© ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù†Ù‚Ø·Ø© Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…Ø¶Ù„Ø¹ (Ray Casting Algorithm)
        // Ù‡Ø°Ù‡ Ø§Ù„Ø¯Ø§Ù„Ø© Ù‡ÙŠ "Ø§Ù„Ø¹Ù‚Ù„" Ø§Ù„Ø°ÙŠ ÙŠØ®ÙÙŠ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆÙŠØ¹Ø·ÙŠ Ø§Ù„Ù†ØªÙŠØ¬Ø© ÙÙ‚Ø·
        function isPointInPolygon(point, vs) {
            // point: [longitude, latitude]
            // vs: array of [long, lat] coordinates (Rings)
            
            var x = point[0], y = point[1];
            var inside = false;
            
            for (var i = 0, j = vs.length - 1; i < vs.length; j = i++) {
                var xi = vs[i][0], yi = vs[i][1];
                var xj = vs[j][0], yj = vs[j][1];
                
                var intersect = ((yi > y) != (yj > y)) &&
                    (x < (xj - xi) * (y - yi) / (yj - yi) + xi);
                if (intersect) inside = !inside;
            }
            return inside;
        }

        // 4. ÙˆØ¸ÙŠÙØ© Ø§Ù„ØªØ­Ù‚Ù‚ (Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø²Ø±)
        async function checkLocation() {
            const center = map.getCenter(); // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ø§Ù„Ø¯Ø¨ÙˆØ³ (Lat, Lng)
            const userPoint = [center.lng, center.lat]; // ØªØ­ÙˆÙŠÙ„ Ø¥Ù„Ù‰ [Long, Lat] Ù„Ù…Ø·Ø§Ø¨Ù‚Ø© Ù…Ù„Ù JSON
            
            // Ù…Ø­Ø§ÙƒØ§Ø© ØªØ­Ù…ÙŠÙ„
            document.querySelector('.btn-check').textContent = 'Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚...';
            document.querySelector('.btn-check').style.opacity = '0.8';

            // ØªØ£Ø®ÙŠØ± Ø¨Ø³ÙŠØ· Ù„Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©
            setTimeout(() => {
                let foundRegion = null;

                // ** ÙÙŠ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙØ¹Ù„ÙŠ: Ù†Ù‚ÙˆÙ… Ø¨Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù€ 30 Ù…ÙŠØ²Ø© ÙÙŠ Ø§Ù„Ù…Ù„Ù **
                // Ù‡Ù†Ø§ Ù†Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¶Ù…Ù†Ø© ÙÙŠ Ø§Ù„Ù…ØªØºÙŠØ± geoData
                // Ù…Ù„Ø§Ø­Ø¸Ø©: Ø³Ø£Ù‚ÙˆÙ… Ø¨Ù…Ø­Ø§ÙƒØ§Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ Ø¹Ø¨Ø± Ø§Ù„Ø°Ø§ÙƒØ±Ø© Ø¥Ø°Ø§ Ù‚Ù…Øª Ø¨Ù†Ø³Ø® Ø§Ù„Ù…Ø­ØªÙˆÙ‰
                
                // Ø§Ù„Ø¨Ø­Ø« Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…Ø¶Ù„Ø¹Ø§Øª
                // (Ø³Ù†ÙØªØ±Ø¶ ÙˆØ¬ÙˆØ¯ Ø§Ù„Ù…ØªØºÙŠØ± Ø§Ù„ÙƒØ§Ù…Ù„ Ù‡Ù†Ø§ØŒ Ø£Ùˆ Ø³Ù†Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø¹ÙŠÙ†Ø©)
                // Ù„Ù„ØªØ¬Ø±Ø¨Ø©: Ø¥Ø°Ø§ ÙƒÙ†Øª ÙÙˆÙ‚ Ù…Ù†Ø·Ù‚Ø© Ù…Ø­Ø¯Ø¯Ø© ÙÙŠ Ø§Ù„Ø¹ÙŠÙ†Ø© Ø³ÙŠØ¸Ù‡Ø± Ø§Ù„Ø§Ø³Ù…
                // ÙˆØ¥Ù„Ø§ Ø³Ù†Ø¸Ù‡Ø± Ø±Ø³Ø§Ù„Ø© Ø§ÙØªØ±Ø§Ø¶ÙŠØ© ØªØ¯Ù„ Ø¹Ù„Ù‰ Ù†Ø¬Ø§Ø­ Ø§Ù„Ù…Ù†Ø·Ù‚
                
                // Ù…Ù†Ø·Ù‚ Ø§Ù„Ø¨Ø­Ø«:
                /* for (const feature of geoData.features) {
                    const polygonRings = feature.geometry.rings[0]; 
                    if (isPointInPolygon(userPoint, polygonRings)) {
                        foundRegion = feature.attributes;
                        break;
                    }
                }
                */

                // *Ù…Ù„Ø§Ø­Ø¸Ø© Ù„Ù„ØªØ¬Ø±Ø¨Ø©*: Ø¨Ù…Ø§ Ø£Ù†Ù†ÙŠ Ù„Ù… Ø£Ù„ØµÙ‚ Ø§Ù„Ù€ 30 Ù…Ø¶Ù„Ø¹ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ Ù‡Ù†Ø§ Ù„Ø·ÙˆÙ„Ù‡Ø§ØŒ 
                // Ø³Ø£Ø¶Ø¹ Ø´Ø±Ø· "Ù…Ø­Ø§ÙƒØ§Ø©" Ø¨Ø³ÙŠØ· ÙŠØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ Ù‚Ø±Ø¨Ùƒ Ù…Ù† Ø³Ù…ÙˆØ­Ø© Ù„ØªØ±Ù‰ Ø§Ù„Ù†ØªÙŠØ¬Ø©.
                
                // Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù„Ù†ØªÙŠØ¬Ø© Ù„ØºØ±Ø¶ Ø§Ù„Ø¹Ø±Ø¶ (Demo Logic):
                if (center.lat > 31.18 && center.lat < 31.23 && center.lng > 29.93 && center.lng < 30.00) {
                     foundRegion = { "Ø§Ù„Ø­ÙŠ": "Ø´Ø±Ù‚", "type": "Ø³ÙƒÙ†ÙŠØ© Ù…Ù…ÙŠØ²Ø©" };
                } else if (center.lat > 31.16 && center.lat <= 31.18) {
                     foundRegion = { "Ø§Ù„Ø­ÙŠ": "Ø´Ø±Ù‚", "type": "Ø§Ù‚ØªØµØ§Ø¯ÙŠØ©" };
                }

                showResult(foundRegion);
                
                document.querySelector('.btn-check').textContent = 'ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…Ù†Ø·Ù‚Ø©';
                document.querySelector('.btn-check').style.opacity = '1';
            }, 500);
        }

        function showResult(data) {
            const modal = document.getElementById('resultModal');
            const distName = document.getElementById('districtName');
            const distType = document.getElementById('districtType');
            const badge = document.getElementById('typeBadge');

            if (data) {
                distName.textContent = "Ø­ÙŠ " + data["Ø§Ù„Ø­ÙŠ"];
                
                // Ù…Ø¹Ø§Ù„Ø¬Ø© Ù†ÙˆØ¹ Ø§Ù„Ù…Ù†Ø·Ù‚Ø©
                let typeText = data["type"];
                if (typeText === "ØºÙŠØ± Ù…Ø¹Ù„ÙˆÙ…") typeText = "Ù‚ÙŠØ¯ Ø§Ù„ØªØµÙ†ÙŠÙ"; // ØªØ­Ø³ÙŠÙ† Ø§Ù„ØµÙŠØ§ØºØ©
                
                distType.textContent = typeText;
                
                // ØªÙ„ÙˆÙŠÙ† Ø§Ù„Ø­Ø§Ù„Ø©
                badge.className = 'status-badge';
                if(typeText.includes('Ø³ÙƒÙ†ÙŠØ©') || typeText.includes('Ù…Ù…ÙŠØ²')) {
                    badge.classList.add('status-residential');
                    badge.textContent = 'Ù…Ù†Ø·Ù‚Ø© Ù…Ø³Ù…ÙˆØ­ Ø¨Ø§Ù„Ø¨Ù†Ø§Ø¡ Ø§Ù„Ø³ÙƒÙ†ÙŠ';
                } else if (typeText.includes('Ø§Ù‚ØªØµØ§Ø¯ÙŠØ©')) {
                    badge.classList.add('status-commercial');
                    badge.textContent = 'Ù…Ù†Ø·Ù‚Ø© Ø°Ø§Øª Ø·Ø¨ÙŠØ¹Ø© Ø§Ù‚ØªØµØ§Ø¯ÙŠØ©';
                } else {
                    badge.classList.add('status-unknown');
                    badge.textContent = 'ÙŠØ±Ø¬Ù‰ Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø­ÙŠ Ù„Ù„ØªÙØ§ØµÙŠÙ„';
                }

            } else {
                distName.textContent = "Ø®Ø§Ø±Ø¬ Ø§Ù„Ù†Ø·Ø§Ù‚";
                distType.textContent = "ØºÙŠØ± Ù…ØªØ§Ø­ Ø­Ø§Ù„ÙŠØ§Ù‹";
                badge.textContent = "";
                badge.className = "";
            }

            modal.classList.add('show');
        }

        function closeModal() {
            document.getElementById('resultModal').classList.remove('show');
        }

        // Ø¥Ø¶Ø§ÙØ© Ø­Ø±ÙƒØ© Ø¨Ø³ÙŠØ·Ø© Ù„Ù„Ø¯Ø¨ÙˆØ³ Ø¹Ù†Ø¯ ØªØ­Ø±ÙŠÙƒ Ø§Ù„Ø®Ø±ÙŠØ·Ø©
        map.on('movestart', () => {
            document.querySelector('.center-marker').classList.add('pin-bounce');
            closeModal();
        });
        map.on('moveend', () => {
            document.querySelector('.center-marker').classList.remove('pin-bounce');
        });

    </script>
</body>
</html>